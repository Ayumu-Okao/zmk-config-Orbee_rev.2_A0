#include "Orbee.dtsi"

// ğŸ’¡ ä¿®æ­£ç®‡æ‰€ 1: è»¸ã®å®šç¾©ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã®å†’é ­ã«ç§»å‹•
/ {
    trackball_listener {
        compatible = "zmk,input-listener";
        device = <&trackball>;
    };

    // ZMKã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è»¸ã®å®šç¾© (PMW3610ãƒãƒ¼ãƒ‰ãŒå‚ç…§ã™ã‚‹)
    zmk_scroll_x_axis: zmk-scroll-x-axis {
        compatible = "zmk,scroll-axis";
        hid-usage = <0x01 0x30>; // X
        scroll-divisor = <1>;
    };

    zmk_scroll_y_axis: zmk-scroll-y-axis {
        compatible = "zmk,scroll-axis";
        hid-usage = <0x01 0x31>; // Y
        scroll-divisor = <1>;
    };
    
    // ZMKã®ãƒã‚¤ãƒ³ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«è»¸ã‚’ç™»éŒ²ã™ã‚‹ãŸã‚ã®ãƒãƒ¼ãƒ‰
    zmk_pointer_axes {
        compatible = "zmk,pointer-axes";
        pointer-axes = <&zmk_scroll_x_axis &zmk_scroll_y_axis>;
    };
};

&default_transform {
    col-offset = <6>;
};

&kscan0 {
    // ... (kscan0 ã®å®šç¾©) ...
};

&pinctrl {
    // ... (pinctrl ã®å®šç¾©) ...
};

&spi0 {
    compatible = "nordic,nrf-spim";

    pinctrl-0 = <&spi0_default>;
    pinctrl-1 = <&spi0_sleep>;
    pinctrl-names = "default", "sleep";
    
    status = "okay"; 

    cs-gpios = <&gpio0 9 GPIO_ACTIVE_LOW>;

    trackball: trackball@0 {
        status = "okay";
        compatible = "pixart,pmw3610";
        reg = <0>;
        spi-max-frequency = <2000000>;
        motion-gpios = <&gpio0 2 GPIO_ACTIVE_LOW>;
        automouse-layer = <6>;
        scroll-layers = <5>;
        
        // ğŸ’¡ ä¿®æ­£ç®‡æ‰€ 2: å‚ç…§ã•ã‚Œã‚‹ãƒãƒ¼ãƒ‰ãŒå…ˆã«å®šç¾©ã•ã‚ŒãŸãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚Œã‚‹
        zephyr,axis-x = <&zmk_scroll_x_axis>;
        zephyr,axis-y = <&zmk_scroll_y_axis>;
    };
};
